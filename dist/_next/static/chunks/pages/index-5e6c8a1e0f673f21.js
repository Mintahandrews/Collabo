(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return o(4760)}])},5650:function(e,t,o){"use strict";o.d(t,{r:function(){return n}});let n=[...Object.values({PURPLE:"#6B32F3",BLUE:"#408FF8",RED:"#F32D27",GREEN:"#6FCB12",GOLD:"#A89D6C",PINK:"#EB29DA",MINT:"#19CB87",RED_LIGHT:"#ED7878",CYAN:"#02CBF6",RED_DARK:"#BA1555",ORANGE:"#FF7300"})]},9283:function(e,t,o){"use strict";o.d(t,{W:function(){return r}});var n=o(9922);let r=(0,n.ZP)((()=>{{let e=window.location.protocol,t=window.location.host;return"".concat(e,"//").concat(t)}})(),{reconnection:!0,reconnectionAttempts:1/0,reconnectionDelay:1e3,reconnectionDelayMax:5e3,timeout:2e4,transports:["websocket","polling"],forceNew:!0,autoConnect:!0,path:"/socket.io"});r.on("connect",()=>{console.log("Socket connected successfully")}),r.on("disconnect",e=>{console.log("Socket disconnected: ".concat(e)),("transport close"===e||"ping timeout"===e)&&(console.log("Attempting to reconnect..."),setTimeout(()=>{r.connect()},1e3))}),r.on("connect_error",e=>{console.error("Socket connection error:",e),setTimeout(()=>{console.log("Attempting to reconnect after error..."),r.connect()},1e3)}),r.on("reconnect",e=>{console.log("Socket reconnected after ".concat(e," attempts"))}),r.on("reconnect_error",e=>{console.error("Socket reconnect error:",e)}),r.on("reconnect_failed",()=>{console.error("Socket reconnection failed after all attempts"),setTimeout(()=>{console.log("Attempting to reconnect after failure..."),r.connect()},2e3)})},5323:function(e,t,o){"use strict";o.d(t,{NW:function(){return n.NW},av:function(){return n.av},bo:function(){return n.bo},u4:function(){return n.u4}}),o(2305);var n=o(5222)},2305:function(e,t,o){"use strict";o.d(t,{X:function(){return s},p:function(){return r}});var n=o(2804);let r={id:"",userId:"",users:new Map,usersMoves:new Map,movesWithoutUser:[],myMoves:[]},s=(0,n.cn)({key:"roomState",default:r})},5222:function(e,t,o){"use strict";o.d(t,{av:function(){return d},NW:function(){return c},bb:function(){return u},u4:function(){return a},bo:function(){return i}});var n=o(2804),r=o(5650);let s=e=>{let t=r.r.findIndex(t=>t===e);return -1===t?r.r[0]:r.r[(t+1)%r.r.length]};var l=o(2305);let c=()=>{let e=(0,n.sJ)(l.X);return e},u=()=>{let e=(0,n.Zl)(l.X);return e},a=()=>{let e=(0,n.Zl)(l.X);return t=>{e({...l.p,id:t})}},i=()=>{let e=(0,n.Zl)(l.X);return{handleAddUser:(t,o)=>{e(e=>{var n;let r=e.users,l=e.usersMoves,c=s(null===(n=[...r.values()].pop())||void 0===n?void 0:n.color);return r.set(t,{name:o,color:c}),l.set(t,[]),{...e,users:r,usersMoves:l}})},handleRemoveUser:t=>{e(e=>{let o=e.users,n=e.usersMoves,r=n.get(t);o.delete(t),n.delete(t);let s=Array.isArray(e.movesWithoutUser)?e.movesWithoutUser:[];return{...e,users:o,usersMoves:n,movesWithoutUser:[...s,...r||[]]}})},handleAddMoveToUser:(t,o)=>{e(e=>{let n=e.usersMoves,r=e.usersMoves.get(t);return n.set(t,[...r||[],o]),{...e,usersMoves:n}})},handleRemoveMoveFromUser:t=>{e(e=>{let o=e.usersMoves,n=e.usersMoves.get(t);return null==n||n.pop(),o.set(t,n||[]),{...e,usersMoves:o}})}}},d=()=>{let[e,t]=(0,n.FV)(l.X);return{handleAddMyMove:e=>{t(t=>{var o;return(null===(o=t.myMoves[t.myMoves.length-1])||void 0===o?void 0:o.options.mode)==="select"?{...t,myMoves:[...t.myMoves.slice(0,t.myMoves.length-1),e]}:{...t,myMoves:[...t.myMoves,e]}})},handleRemoveMyMove:()=>{let o=[...e.myMoves],n=o.pop();return t(e=>({...e,myMoves:o})),n},myMoves:e.myMoves}}},9477:function(e,t,o){"use strict";var n=o(5893),r=o(8193),s=o(4922);t.Z=e=>{let{id:t}=e,{closeModal:o}=(0,s.d)();return(0,n.jsxs)("div",{className:"relative flex flex-col items-center rounded-md bg-white p-10 ",children:[(0,n.jsx)("button",{onClick:o,className:"absolute top-5 right-5",children:(0,n.jsx)(r.oHP,{})}),(0,n.jsxs)("h2",{className:"text-lg font-bold",children:['Room with id "',t,'" does not exist or is full!']}),(0,n.jsx)("h3",{children:"Try to join room later."})]})}},4760:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return d}});var n=o(5893),r=o(7294),s=o(1163),l=o(9283),c=o(4922),u=o(5323),a=o(9477),i=()=>{let{openModal:e}=(0,c.d)(),t=(0,u.u4)(),[o,i]=(0,r.useState)(""),[d,m]=(0,r.useState)(""),f=(0,s.useRouter)();return(0,r.useEffect)(()=>{document.body.style.backgroundColor="white"},[]),(0,r.useEffect)(()=>{l.W.on("created",e=>{t(e),f.push(e)});let r=(r,s)=>{s?e((0,n.jsx)(a.Z,{id:o})):(t(r),f.push(r))};return l.W.on("joined",r),()=>{l.W.off("created"),l.W.off("joined",r)}},[e,o,f,t]),(0,r.useEffect)(()=>{l.W.emit("leave_room"),t("")},[t]),(0,n.jsxs)("div",{className:"flex flex-col items-center py-24",children:[(0,n.jsx)("h1",{className:"text-5xl font-extrabold leading-tight sm:text-extra",children:"Collaborator"}),(0,n.jsx)("h3",{className:"text-xl sm:text-2xl",children:"Real-time whiteboard"}),(0,n.jsxs)("div",{className:"mt-10 flex flex-col gap-2",children:[(0,n.jsx)("label",{className:"self-start font-bold leading-tight",children:"Username"}),(0,n.jsx)("input",{type:"text",value:d,onChange:e=>m(e.target.value),placeholder:"Enter your name",className:"rounded-lg border border-gray-300 p-2 text-lg focus:border-gray-600 focus:outline-none",required:!0})]}),(0,n.jsxs)("div",{className:"mt-6 flex flex-col gap-2",children:[(0,n.jsx)("label",{className:"self-start font-bold leading-tight",children:"Room ID (optional)"}),(0,n.jsxs)("form",{onSubmit:e=>{e.preventDefault(),o&&l.W.emit("join_room",o,d)},className:"flex gap-2",children:[(0,n.jsx)("input",{type:"text",value:o,onChange:e=>i(e.target.value),placeholder:"Enter room id",className:"rounded-lg border border-gray-300 p-2 text-lg focus:border-gray-600 focus:outline-none"}),(0,n.jsx)("button",{type:"submit",className:"rounded-lg bg-gray-800 px-3 py-2 text-white transition-colors hover:bg-gray-700 disabled:cursor-not-allowed disabled:bg-gray-800 disabled:bg-opacity-50",disabled:!d||!o,children:"Join"})]})]}),(0,n.jsx)("div",{className:"mt-8 self-center",children:(0,n.jsx)("button",{type:"button",className:"rounded-lg bg-gray-800 px-6 py-2 text-white transition-colors hover:bg-gray-700 disabled:cursor-not-allowed disabled:bg-opacity-50",onClick:()=>{l.W.emit("create_room",d)},disabled:!d,children:"Create Room"})})]})},d=()=>(0,n.jsx)(i,{})}},function(e){e.O(0,[617,642,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);